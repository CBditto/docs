# Troubleshooting

## Ditto won't sync

If you are having trouble synchronizing devices in Ditto, follow this guide.

### Synchronization seems slow, or comes to a halt over time

Ensure that you are only creating a fixed number of live queries. Each live query will 

### General diagnostics

1. Set `DittoLogger.minimumLogLevel = DittoLogLevel.VERBOSE` before you initialize `Ditto(identity)`.
1. Look at the logs. Do you see any helpful errors or warnings?
1. Verify that your app id is the same on all devices

### Bluetooth 

1. Turn Use Location on
1. Turn Bluetooth Scanning on
1. Are permissions set correctly? See [installation](../installation).
1. Go to your OS-level permissions for Bluetooth and clear the app permissions for your application.
1. Delete the app, install it again, and open it. Does it ask for Bluetooth permissions?
1. Android only: are you calling `ditto.refreshPermissions()`?

### Apple Wireless Direct Link, P2P-Wifi, Wifi Aware 

1. Are permissions set correctly? See [installation](../installation).
1. Go to your OS-level permissions and clear the app permissions for your application.
1. Delete the app, install it again, and open it. Does it ask for location permissions?
1. If you are using a custom `TransportConfig`, make sure you have enabled all peer-to-peer transports using `enableAllPeerToPeer()`.

### Local Area Network (LAN)

1. Are permissions set correctly? See [installation](../installation).
1. Are both devices connected to the same WiFi network?
1. Check your router settings and see the [LAN troubleshooting guide](./mesh-network/supported-transports/#local-area-network).

### Online Playground 

#### Did you copy your playground token and App ID correctly? 

1. Login to the [Portal](https://portal.ditto.live) 
1. Go to your App.
1. Make sure that the portal playground token is the same as the value you are using in your code.

![Online Playground enabled in the Ditto Portal](./mesh-network/portal-playground-setting.png)

#### Did your device connect to the internet?

`OnlinePlayground` applications must connect to the Big Peer first
*before* going offline. [Read more about online playground](./mesh-network/online-playground).

If your app need full offline access without ever connecting to the Internet, please
request an [offline license token](./mesh-network/offline-license).

#### Do you have a firewall or proxy enabled that is blocking Ditto's connection to the Big Peer?

Verify that you can reach the following endpoints:

```
> nc -v MY_APP_ID.cloud.ditto.live 443
Connection to MY_APP_ID.cloud.ditto.live port 443 [tcp/https] succeeded!
^C
```

```
> curl -i https://MY_APP_ID.cloud.ditto.live/_ditto/auth/login
HTTP/1.1 405 Method Not Allowed
Date: Fri, 30 Sep 2022 02:03:36 GMT
Content-Type: text/plain; charset=utf-8
Content-Length: 23
Connection: keep-alive
Access-Control-Allow-Origin: *
Access-Control-Allow-Credentials: true
Access-Control-Allow-Methods: GET, PUT, POST, DELETE, PATCH, OPTIONS
Access-Control-Allow-Headers: X-DITTO-ENSURE-INSERT,X-HYDRA-ENSURE-INSERT,X-DITTO-CLIENT-ID,X-HYDRA-CLIENT-ID,Accept,Referer,Keep-Alive,User-Agent,X-Requested-With,If-Modified-Since,Cache-Control,Content-Type,Authorization,X-Forwarded-For
Access-Control-Max-Age: 1728000

HTTP method not allowed% 
```

Some corporate networks, firewalls, or proxies block the HTTP upgrade packet
that tells the WebSocket server to keep the connection alive. Check with your
IT administrator to see if your computer is configured to block WebSocket connections.

### Online with Authentication

1. Did you follow the [tutorial](./guides/authentication/intro)?
1. Is the website address behind `https` and available on the open Internet? 
1. Verfiy that your server is reachable by the Big Peer at `https://APP_ID.ditto.live` and `https://cloud.ditto.live`.
1. Are you implementing the [authentication expiring soon](./security/online-with-authentication#creating-your-client) delegate?
1. Verify that your webhook provider name is [correctly copied in the Ditto portal](./security/online-with-authentication#login).

### Offline Playground and Shared Key

1. Login to the [Ditto Portal](https://portal.ditto.live).
1. Check the value of your offline license token in the Ditto Portal. Is the offline license token expired?
1. Is the offline license token copied correctly?
1. Is the shared key copied correctly? [Generate a new shared key.](./security/shared-key)

### Still having trouble?

1. Are you creating many live queries? Reduce the number of live queries in your app. 

Email us at [support@ditto.live](support.ditto.live) or [login to your Ditto account](https://portal.ditto.live) to chat with the support bot in the
lower right corner of your screen. An engineer will reach out to you shortly.

