<!doctype html>
<html class="docs-version-current" lang="en" dir="ltr">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width,initial-scale=1">
<meta name="generator" content="Docusaurus v2.0.0-beta.9">
<link rel="preconnect" href="https://www.google-analytics.com">
<link rel="preconnect" href="https://www.googletagmanager.com">
<script async src="https://www.googletagmanager.com/gtag/js?id=G-D8PMW3CCL2"></script>
<script>function gtag(){dataLayer.push(arguments)}window.dataLayer=window.dataLayer||[],gtag("js",new Date),gtag("config","G-D8PMW3CCL2",{})</script>
<!-- Google Tag Manager -->
    <script>!function(e,t,a,n,g){e[n]=e[n]||[],e[n].push({"gtm.start":(new Date).getTime(),event:"gtm.js"});var m=t.getElementsByTagName(a)[0],r=t.createElement(a);r.async=!0,r.src="https://www.googletagmanager.com/gtm.js?id=GTM-PV7QFWF",m.parentNode.insertBefore(r,m)}(window,document,"script","dataLayer")</script>
    <!-- End Google Tag Manager --><title data-react-helmet="true">Avoiding Excessive Memory Consumption | Ditto</title><meta data-react-helmet="true" name="twitter:card" content="summary_large_image"><meta data-react-helmet="true" property="og:url" content="https://docs.ditto.live/quick-tips/ios/avoiding-excessive-memory-consumption"><meta data-react-helmet="true" name="docusaurus_locale" content="en"><meta data-react-helmet="true" name="docusaurus_version" content="current"><meta data-react-helmet="true" name="docusaurus_tag" content="docs-default-current"><meta data-react-helmet="true" property="og:title" content="Avoiding Excessive Memory Consumption | Ditto"><meta data-react-helmet="true" name="description" content="Ditto&#x27;s documents have value semantics by design. This means that whenever you"><meta data-react-helmet="true" property="og:description" content="Ditto&#x27;s documents have value semantics by design. This means that whenever you"><link data-react-helmet="true" rel="shortcut icon" href="/img/favicon.ico/favicon.ico"><link data-react-helmet="true" rel="canonical" href="https://docs.ditto.live/quick-tips/ios/avoiding-excessive-memory-consumption"><link data-react-helmet="true" rel="alternate" href="https://docs.ditto.live/quick-tips/ios/avoiding-excessive-memory-consumption" hreflang="en"><link data-react-helmet="true" rel="alternate" href="https://docs.ditto.live/quick-tips/ios/avoiding-excessive-memory-consumption" hreflang="x-default"><link rel="stylesheet" href="/assets/css/styles.3dcc162a.css">
<link rel="preload" href="/assets/js/runtime~main.f2987ee9.js" as="script">
<link rel="preload" href="/assets/js/main.fa700d7c.js" as="script">
</head>
<body>
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){var t=null;try{t=localStorage.getItem("theme")}catch(t){}return t}();t(null!==e?e:"light")}()</script><div id="__docusaurus">
<div><a href="#" class="skipToContent_1oUP">Skip to main content</a></div><nav class="navbar navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><button aria-label="Navigation bar toggle" class="navbar__toggle clean-btn" type="button" tabindex="0"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke="currentColor" width="25" height="25"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 6h16M4 12h16M4 18h16"></path></svg></button><a class="navbar__brand" href="/"><div class="navbar__logo"><img src="/img/logo.png" alt="Ditto Logo" class="themedImage_1VuW themedImage--light_3UqQ"><img src="/img/logo.png" alt="Ditto Logo" class="themedImage_1VuW themedImage--dark_hz6m"></div><b class="navbar__title">Ditto</b></a><a class="navbar__item navbar__link" href="/">Home</a><a href="https://github.com/getditto/samples" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link"><span class="inline">Samples Apps</span></a><a href="https://github.com/getditto/docs/issues" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link"><span class="inline">GitHub Issues</span></a><a href="https://github.com/getditto/docs/discussions" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link"><span class="inline">Discussions</span></a><a href="https://github.com/getditto/docs/discussions/categories/roadmap-and-ideas" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link"><span class="inline">Roadmap</span></a><a class="navbar__item navbar__link" href="/changelog">Changelog</a></div><div class="navbar__items navbar__items--right"><a href="https://portal.ditto.live" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link"><span class="inline">Get Started</span></a></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div class="main-wrapper docs-wrapper docs-doc-page"><div class="docPage_31aa"><button aria-label="Scroll back to top" class="clean-btn theme-back-to-top-button backToTopButton_35hR" type="button"></button><aside class="docSidebarContainer_3Kbt"><div class="sidebar_15mo"><nav class="menu thin-scrollbar menu_Bmed"><ul class="theme-doc-sidebar-menu menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/">Introduction</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><a class="menu__link menu__link--sublist" href="#">Installation</a><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/installation/javascript">JavaScript</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/installation/ios">iOS</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/installation/android">Android</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/installation/csharp">C#</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/installation/cpp">C++</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/installation/linux">Linux (Raspberry Pi)</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/installation/rust">Rust</a></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#">Concepts</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#">Tutorials</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><a class="menu__link menu__link--sublist menu__link--active" href="#">Quick Tips</a><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item"><a class="menu__link menu__link--sublist menu__link--active" href="#" tabindex="0">iOS</a><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/quick-tips/ios/codables">Using Ditto with Codable Support</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/quick-tips/ios/uitableview-animations-with-observe">Animating UITableView with the Observe API</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link menu__link--active" aria-current="page" tabindex="0" href="/quick-tips/ios/avoiding-excessive-memory-consumption">Avoiding Excessive Memory Consumption</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/quick-tips/ios/preventing-swiftui-previews-from-syncing">Preventing SwiftUI Previews from Syncing</a></li></ul></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#">Advanced</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/faq">Frequently Asked Questions</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/changelog">Changelog</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#">API Reference</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a href="https://github.com/getditto/docs/issues" target="_blank" rel="noopener noreferrer" class="menu__link"><span>GitHub Issues</span></a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a href="https://github.com/getditto/docs/discussions/categories/roadmap-and-ideas" target="_blank" rel="noopener noreferrer" class="menu__link"><span>Roadmap</span></a></li></ul></nav></div></aside><main class="docMainContainer_3ufF"><div class="container padding-top--md padding-bottom--lg"><div class="row"><div class="col docItemCol_2rXS"><div class="docItemContainer_1EXp"><article class="prose max-w-none"><div class="tocCollapsible_1PrD theme-doc-toc-mobile tocMobile_Ftrd"><button type="button" class="clean-btn tocCollapsibleButton_2O1e">On this page</button></div><div class="theme-doc-markdown markdown"><header><h1>Avoiding Excessive Memory Consumption</h1></header><p>Ditto&#x27;s documents have value semantics by design. This means that whenever you
get a <code>DittoDocument</code> from the Ditto API, it&#x27;s referencing an individual <em>copy</em>
of the corresponding document data in-memory, plus quite a bit of book-keeping.
To keep the memory footprint low, it is therefore crucial to <em>release those
blobs of data as early as possible</em>, freeing the claimed memory space.</p><p>Special care needs to be taken whenever you spread the work across multiple
queues or async APIs. It is very easy to end up with a lot of work items on a
queue, each holding on to large amounts of data, such as big arrays of Ditto
documents. This isn&#x27;t always obvious, leads to mysterious excessive memory
consumption, eventually resulting in an out-of memory crash, especially on
mobile devices.</p><h2 class="anchor anchorWithStickyNavbar_31ik" id="live-queries">Live Queries<a aria-hidden="true" class="hash-link" href="#live-queries" title="Direct link to heading">​</a></h2><p>Live queries are particularly prone to this problem. Consider the following
typical example:</p><div class="codeBlockContainer_2gih"><div class="codeBlockContent_3z4W swift"><pre tabindex="0" class="prism-code language-swift codeBlock_6upA thin-scrollbar"><code class="codeBlockLines_xlV7"><span class="token-line" style="color:#9CDCFE"><span class="token plain">// BAD:</span></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">self.liveQuery = ditto.store.collection(&quot;A&quot;).findAll().observe { [weak self] documents, event in</span></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">    self?.documentProcessingQueue.async {</span></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">        print(&quot;[INFO] Processing \(documents.count) changed documents...&quot;)</span></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">        // Inspect the changed documents, update UI state, etc.</span></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">    }</span></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">}</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_2e3i clean-btn"><div><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke="currentColor" class="w-4 h-4 inline mr-1"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 5H7a2 2 0 00-2 2v12a2 2 0 002 2h10a2 2 0 002-2V7a2 2 0 00-2-2h-2M9 5a2 2 0 002 2h2a2 2 0 002-2M9 5a2 2 0 012-2h2a2 2 0 012 2"></path></svg><span class="text-xs">Copy</span></div></button></div></div><p>Depending on the amount of documents in the store and especially the rate at
which those are updated, that observation callback might be called many times,
each time with a fresh copy of the documents data (because value semantics) held
in-memory. Each of those dispatches will hold on to these document copies until
the work item had a chance to run. If the <code>documentProcessingQueue</code> can&#x27;t keep
up processing those documents and releasing them fast enough, more and more
documents are accumulated in memory waiting to be processed, resulting in
excessive memory use.</p><h2 class="anchor anchorWithStickyNavbar_31ik" id="back-pressure">Back Pressure<a aria-hidden="true" class="hash-link" href="#back-pressure" title="Direct link to heading">​</a></h2><p>To deal with these situations, all of our APIs prone to this problem have more
advanced variants allowing you to control the rate at which those callbacks are
called. This mechanism is commonly referred to as <em>Back Pressure</em> (see for example
<a href="https://tanaschita.com/20211205-back-pressure-in-combine" target="_blank" rel="noopener noreferrer">here</a> and
<a href="https://medium.com/@jayphelps/backpressure-explained-the-flow-of-data-through-software-2350b3e77ce7" target="_blank" rel="noopener noreferrer">here</a>).
Here is a much safer and more efficient way to implement the example above:</p><div class="codeBlockContainer_2gih"><div class="codeBlockContent_3z4W swift"><pre tabindex="0" class="prism-code language-swift codeBlock_6upA thin-scrollbar"><code class="codeBlockLines_xlV7"><span class="token-line" style="color:#9CDCFE"><span class="token plain">// BETTER:</span></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">self.liveQuery = ditto.store.collection(&quot;A&quot;).findAll().observeWithNextSignal { [weak self] documents, event, signalNext in</span></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">    self?.documentProcessingQueue.async {</span></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">        print(&quot;[INFO] Processing \(documents.count) changed documents...&quot;)</span></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">        // Inspect the changed documents, update UI state, etc.</span></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">        </span></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">        // Tell Ditto we are done and ready to process the next batch:</span></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">        signalNext()</span></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">    }</span></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">}</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_2e3i clean-btn"><div><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke="currentColor" class="w-4 h-4 inline mr-1"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 5H7a2 2 0 00-2 2v12a2 2 0 002 2h10a2 2 0 002-2V7a2 2 0 00-2-2h-2M9 5a2 2 0 002 2h2a2 2 0 002-2M9 5a2 2 0 012-2h2a2 2 0 012 2"></path></svg><span class="text-xs">Copy</span></div></button></div></div><p>Since this particular pattern is so common, Ditto offers a convenience variant.
But it requires <em>all work to be performed within the callback</em> without
dispatching onto different queues or using any async API that would hold on to
the documents.</p><div class="codeBlockContainer_2gih"><div class="codeBlockContent_3z4W swift"><pre tabindex="0" class="prism-code language-swift codeBlock_6upA thin-scrollbar"><code class="codeBlockLines_xlV7"><span class="token-line" style="color:#9CDCFE"><span class="token plain">// CONVENIENT:</span></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">self.liveQuery = ditto.store.collection(&quot;A&quot;).findAll().observe(deliverOn: self.documentProcessingQueue) { [weak self] documents, event in</span></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">        print(&quot;[INFO] Processing \(documents.count) changed documents...&quot;)</span></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">        // Inspect the changed documents, update UI state, etc.</span></span><span class="token-line" style="color:#9CDCFE"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">        // IMPORTANT: all work needs to be performed within this block without</span></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">        // dispatching onto different queues or using any async APIs.</span></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">        </span></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">        // In this case, Ditto will internally call `signalNext` for us when</span></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">        // this block finishes.</span></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">    }</span></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">}</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_2e3i clean-btn"><div><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke="currentColor" class="w-4 h-4 inline mr-1"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 5H7a2 2 0 00-2 2v12a2 2 0 002 2h10a2 2 0 002-2V7a2 2 0 00-2-2h-2M9 5a2 2 0 002 2h2a2 2 0 002-2M9 5a2 2 0 012-2h2a2 2 0 012 2"></path></svg><span class="text-xs">Copy</span></div></button></div></div><p>Sometimes you do need to use async APIs or dispatch onto more queues (including
the main queue), in which case the following, most versatile, variant should be
used:</p><div class="codeBlockContainer_2gih"><div class="codeBlockContent_3z4W swift"><pre tabindex="0" class="prism-code language-swift codeBlock_6upA thin-scrollbar"><code class="codeBlockLines_xlV7"><span class="token-line" style="color:#9CDCFE"><span class="token plain">// VERSATILE:</span></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">self.liveQuery = ditto.store.collection(&quot;A&quot;).findAll().observeWithNextSignal(deliverOn: self.liveQueryQueue) { [weak self] documents, event, signalNext in</span></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">    // Whenever we have to use asynchronous API that will hold on to the</span></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">    // documents, Ditto won&#x27;t know when it&#x27;s safe to deliver the next batch of</span></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">    // changes, so we have to tell it explicitly by calling `signalNext()`.    </span></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">    self?.processDocumentsAsynchronously(documents) {</span></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">        signalNext()</span></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">    }</span></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">}</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_2e3i clean-btn"><div><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke="currentColor" class="w-4 h-4 inline mr-1"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 5H7a2 2 0 00-2 2v12a2 2 0 002 2h10a2 2 0 002-2V7a2 2 0 00-2-2h-2M9 5a2 2 0 002 2h2a2 2 0 002-2M9 5a2 2 0 012-2h2a2 2 0 012 2"></path></svg><span class="text-xs">Copy</span></div></button></div></div><h2 class="anchor anchorWithStickyNavbar_31ik" id="rule-of-thumb">Rule of Thumb<a aria-hidden="true" class="hash-link" href="#rule-of-thumb" title="Direct link to heading">​</a></h2><p>All of this boils down to the following rule of thumb:</p><hr><p>Use <code>observe(deliverOn:)</code> <em>only</em> if the received <code>documents</code> including the
<code>event</code> are processed and can be released within that callback without
dispatching onto other queues or using any async APIs. Otherwise, use
<code>observeWithNextSignal(deliverOn:)</code> and call the <code>DittoSignalNext</code> block after
the received documents are fully processed and can be released.</p><hr><p>This of course doesn&#x27;t mean that you can never keep a reference to the
documents and use or operate on them later on. In fact, a typical use-case
would be to always keep the latest set of documents returned by a (live) query
to display them in the UI or use otherwise. The important thing is to control
the rate at which those are delivered and let Ditto know when you are ready to
receive the next batch. This rule of thumb can help with that.</p><h2 class="anchor anchorWithStickyNavbar_31ik" id="implementation-details">Implementation Details<a aria-hidden="true" class="hash-link" href="#implementation-details" title="Direct link to heading">​</a></h2><p>The four variants shown in this article are as follows:</p><div class="codeBlockContainer_2gih"><div class="codeBlockContent_3z4W swift"><pre tabindex="0" class="prism-code language-swift codeBlock_6upA thin-scrollbar"><code class="codeBlockLines_xlV7"><span class="token-line" style="color:#9CDCFE"><span class="token plain">- observe(handler:)</span></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">- observe(deliverOn:handler:)</span></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">- observeWithNextSignal(handler:)</span></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">- observeWithNextSignal(deliverOn:handler:)</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_2e3i clean-btn"><div><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke="currentColor" class="w-4 h-4 inline mr-1"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 5H7a2 2 0 00-2 2v12a2 2 0 002 2h10a2 2 0 002-2V7a2 2 0 00-2-2h-2M9 5a2 2 0 002 2h2a2 2 0 002-2M9 5a2 2 0 012-2h2a2 2 0 012 2"></path></svg><span class="text-xs">Copy</span></div></button></div></div><p>The former three are convenience methods and are implemented in terms of the
latter:</p><div class="codeBlockContainer_2gih"><div class="codeBlockContent_3z4W swift"><pre tabindex="0" class="prism-code language-swift codeBlock_6upA thin-scrollbar"><code class="codeBlockLines_xlV7"><span class="token-line" style="color:#9CDCFE"><span class="token plain">.observe() { documents, event in</span></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">    // Process documents.</span></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">}</span></span><span class="token-line" style="color:#9CDCFE"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">// Equivalent to and implemented as:</span></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">.observeWithNextSignal(deliverOn: .main) { documents, event, signalNext in</span></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">    // Process documents.</span></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">    signalNext()</span></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">}</span></span><span class="token-line" style="color:#9CDCFE"><span class="token plain" style="display:inline-block">
</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_2e3i clean-btn"><div><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke="currentColor" class="w-4 h-4 inline mr-1"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 5H7a2 2 0 00-2 2v12a2 2 0 002 2h10a2 2 0 002-2V7a2 2 0 00-2-2h-2M9 5a2 2 0 002 2h2a2 2 0 002-2M9 5a2 2 0 012-2h2a2 2 0 012 2"></path></svg><span class="text-xs">Copy</span></div></button></div></div><div class="codeBlockContainer_2gih"><div class="codeBlockContent_3z4W swift"><pre tabindex="0" class="prism-code language-swift codeBlock_6upA thin-scrollbar"><code class="codeBlockLines_xlV7"><span class="token-line" style="color:#9CDCFE"><span class="token plain">.observe(deliverOn: .someQueue) { documents, event, in</span></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">    // Process documents.</span></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">}</span></span><span class="token-line" style="color:#9CDCFE"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">// Equivalent to and implemented as:</span></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">.observeWithNextSignal(deliverOn: .someQueue) { documents, event, signalNext in</span></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">    // Process documents.</span></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">    signalNext()</span></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">}</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_2e3i clean-btn"><div><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke="currentColor" class="w-4 h-4 inline mr-1"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 5H7a2 2 0 00-2 2v12a2 2 0 002 2h10a2 2 0 002-2V7a2 2 0 00-2-2h-2M9 5a2 2 0 002 2h2a2 2 0 002-2M9 5a2 2 0 012-2h2a2 2 0 012 2"></path></svg><span class="text-xs">Copy</span></div></button></div></div><div class="codeBlockContainer_2gih"><div class="codeBlockContent_3z4W swift"><pre tabindex="0" class="prism-code language-swift codeBlock_6upA thin-scrollbar"><code class="codeBlockLines_xlV7"><span class="token-line" style="color:#9CDCFE"><span class="token plain">.observeWithNextSignal() { documents, event, signalNext in</span></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">    // Process documents.</span></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">    signalNext()</span></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">}</span></span><span class="token-line" style="color:#9CDCFE"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">// Equivalent to and implemented as:</span></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">.observeWithNextSignal(deliverOn: .main) { documents, event, signalNext in</span></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">    // Process documents.</span></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">    signalNext()</span></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">}</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_2e3i clean-btn"><div><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke="currentColor" class="w-4 h-4 inline mr-1"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 5H7a2 2 0 00-2 2v12a2 2 0 002 2h10a2 2 0 002-2V7a2 2 0 00-2-2h-2M9 5a2 2 0 002 2h2a2 2 0 002-2M9 5a2 2 0 012-2h2a2 2 0 012 2"></path></svg><span class="text-xs">Copy</span></div></button></div></div><p>Same is true for the <code>observeLocalXXX</code> variants. Please refer to our API
reference for details.</p></div><footer class="theme-doc-footer docusaurus-mt-lg"><div class="theme-doc-footer-edit-meta-row row"><div class="col"><a href="https://github.com/getditto/docs/edit/master/docs/quick-tips/ios/avoiding-excessive-memory-consumption.md" target="_blank" rel="noreferrer noopener" class="theme-edit-this-page"><svg fill="currentColor" height="20" width="20" viewBox="0 0 40 40" class="iconEdit_2_ui" aria-hidden="true"><g><path d="m34.5 11.7l-3 3.1-6.3-6.3 3.1-3q0.5-0.5 1.2-0.5t1.1 0.5l3.9 3.9q0.5 0.4 0.5 1.1t-0.5 1.2z m-29.5 17.1l18.4-18.5 6.3 6.3-18.4 18.4h-6.3v-6.2z"></path></g></svg>Edit this page</a></div><div class="col lastUpdated_13-_"></div></div></footer></article><nav class="pagination-nav docusaurus-mt-lg" aria-label="Docs pages navigation"><div class="pagination-nav__item"><a class="pagination-nav__link" href="/quick-tips/ios/uitableview-animations-with-observe"><div class="pagination-nav__sublabel">Previous</div><div class="pagination-nav__label">« <!-- -->Animating UITableView with the Observe API</div></a></div><div class="pagination-nav__item pagination-nav__item--next"><a class="pagination-nav__link" href="/quick-tips/ios/preventing-swiftui-previews-from-syncing"><div class="pagination-nav__sublabel">Next</div><div class="pagination-nav__label">Preventing SwiftUI Previews from Syncing<!-- --> »</div></a></div></nav></div></div><div class="col col--3"><div class="tableOfContents_35-E thin-scrollbar theme-doc-toc-desktop"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#live-queries" class="table-of-contents__link toc-highlight">Live Queries</a></li><li><a href="#back-pressure" class="table-of-contents__link toc-highlight">Back Pressure</a></li><li><a href="#rule-of-thumb" class="table-of-contents__link toc-highlight">Rule of Thumb</a></li><li><a href="#implementation-details" class="table-of-contents__link toc-highlight">Implementation Details</a></li></ul></div></div></div></div></main></div></div><footer class="footer footer--dark"><div class="container"><div class="row footer__links"><div class="col footer__col"><div class="footer__title">Docs</div><ul class="footer__items"><li class="footer__item"><a class="footer__link-item" href="/">Quick Start</a></li><li class="footer__item"><a href="https://www.ditto.live/" target="_blank" rel="noopener noreferrer" class="footer__link-item"><span>Main Website</span></a></li><li class="footer__item"><a href="https://github.com/getditto/samples" target="_blank" rel="noopener noreferrer" class="footer__link-item"><span>Samples Apps</span></a></li><li class="footer__item"><a class="footer__link-item" href="/changelog">Changelog</a></li></ul></div><div class="col footer__col"><div class="footer__title">Community</div><ul class="footer__items"><li class="footer__item"><a href="https://github.com/getditto/docs/discussions" target="_blank" rel="noopener noreferrer" class="footer__link-item"><span>GitHub Discussions</span></a></li><li class="footer__item"><a href="https://github.com/getditto/docs/issues" target="_blank" rel="noopener noreferrer" class="footer__link-item"><span>GitHub Issues</span></a></li><li class="footer__item"><a href="https://stackoverflow.com/questions/tagged/ditto" target="_blank" rel="noopener noreferrer" class="footer__link-item"><span>Stack Overflow</span></a></li><li class="footer__item"><a href="https://twitter.com/dittolive" target="_blank" rel="noopener noreferrer" class="footer__link-item"><span>Twitter</span></a></li></ul></div></div><div class="footer__bottom text--center"><div class="footer__copyright">Copyright © 2022 DittoLive, Inc. Built with Docusaurus.</div></div></div></footer></div>
<script src="/assets/js/runtime~main.f2987ee9.js"></script>
<script src="/assets/js/main.fa700d7c.js"></script>
<!-- Google Tag Manager (noscript) -->
    <noscript><iframe src="https://www.googletagmanager.com/ns.html?id=GTM-PV7QFWF" height="0" width="0" style="display:none;visibility:hidden"></iframe></noscript>
    <!-- End Google Tag Manager (noscript) --></body>
</html>